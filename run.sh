#!/bin/bash

# ุณูุฑูุจุช ุชุดุบูู ุจูุช ูุชุฌุฑ ุชูููุฌุฑุงู
# Telegram Store Bot Launcher

echo "๐ ุจุฏุก ุชุดุบูู ุจูุช ูุชุฌุฑ ุชูููุฌุฑุงู ุงูุฅููุชุฑููู..."
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"

# ุงูุชุญูู ูู Python
if ! command -v python3 &> /dev/null; then
    echo "โ ุฎุทุฃ: Python 3 ุบูุฑ ูุซุจุช!"
    echo "ุงูุฑุฌุงุก ุชุซุจูุช Python 3.8 ุฃู ุฃุญุฏุซ"
    exit 1
fi

echo "โ Python ููุฌูุฏ: $(python3 --version)"

# ุงูุชุญูู ูู ุงููุชุทูุจุงุช
if [ ! -f "requirements.txt" ]; then
    echo "โ ุฎุทุฃ: ููู requirements.txt ุบูุฑ ููุฌูุฏ!"
    exit 1
fi

# ุงูุชุญูู ูู ุชุซุจูุช ุงูููุชุจุงุช
echo "๐ ุงูุชุญูู ูู ุงูููุชุจุงุช ุงููุทููุจุฉ..."

if ! python3 -c "import telegram" 2>/dev/null; then
    echo "๐ฆ ุชุซุจูุช ุงูููุชุจุงุช ุงููุทููุจุฉ..."
    pip3 install -r requirements.txt
    
    if [ $? -ne 0 ]; then
        echo "โ ูุดู ุชุซุจูุช ุงูููุชุจุงุช!"
        exit 1
    fi
    echo "โ ุชู ุชุซุจูุช ุงูููุชุจุงุช ุจูุฌุงุญ"
else
    echo "โ ุงูููุชุจุงุช ูุซุจุชุฉ ูุณุจูุงู"
fi

# ุงูุชุญูู ูู ููู ุงูุชูููู
if [ ! -f "config.py" ]; then
    echo "โ ุฎุทุฃ: ููู config.py ุบูุฑ ููุฌูุฏ!"
    exit 1
fi

# ุงูุชุญูู ูู ุงูุชููู
if grep -q "YOUR_BOT_TOKEN_HERE" config.py; then
    echo "โ๏ธ  ุชุญุฐูุฑ: ูู ูุชู ุฅุฏุฎุงู ุชููู ุงูุจูุช!"
    echo "ุงูุฑุฌุงุก ูุชุญ config.py ููุถุน ุงูุชููู ุงูุฎุงุต ุจู"
    read -p "ูู ุชุฑูุฏ ุงููุชุงุจุนุฉุ (y/n): " choice
    if [ "$choice" != "y" ]; then
        exit 0
    fi
fi

# ุฅูุดุงุก ุงููุฌูุฏุงุช ุงูุถุฑูุฑูุฉ
echo "๐ ุฅูุดุงุก ุงููุฌูุฏุงุช..."
mkdir -p backups
mkdir -p exports

echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "โจ ุฌุงุฑู ุชุดุบูู ุงูุจูุช..."
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""

# ุชุดุบูู ุงูุจูุช
python3 main.py

# ุนูุฏ ุงูุฅููุงู
echo ""
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "๐ ุชู ุฅููุงู ุงูุจูุช"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
